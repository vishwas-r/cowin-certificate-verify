{"ast":null,"code":"/*!\n * Copyright (c) 2018 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nvar _regeneratorRuntime = require(\"D:/My Works/Git/cowin-verify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\");\n\nvar _asyncToGenerator = require(\"D:/My Works/Git/cowin-verify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\nvar _classCallCheck = require(\"D:/My Works/Git/cowin-verify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"D:/My Works/Git/cowin-verify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _get = require(\"D:/My Works/Git/cowin-verify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/get\");\n\nvar _getPrototypeOf = require(\"D:/My Works/Git/cowin-verify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/getPrototypeOf\");\n\nvar _inherits = require(\"D:/My Works/Git/cowin-verify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/inherits\");\n\nvar _createSuper = require(\"D:/My Works/Git/cowin-verify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createSuper\");\n\nvar ControllerProofPurpose = require('./ControllerProofPurpose');\n\nmodule.exports = /*#__PURE__*/function (_ControllerProofPurpo) {\n  _inherits(AuthenticationProofPurpose, _ControllerProofPurpo);\n\n  var _super = _createSuper(AuthenticationProofPurpose);\n\n  function AuthenticationProofPurpose() {\n    var _this;\n\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$term = _ref.term,\n        term = _ref$term === void 0 ? 'authentication' : _ref$term,\n        controller = _ref.controller,\n        challenge = _ref.challenge,\n        date = _ref.date,\n        domain = _ref.domain,\n        _ref$maxTimestampDelt = _ref.maxTimestampDelta,\n        maxTimestampDelta = _ref$maxTimestampDelt === void 0 ? Infinity : _ref$maxTimestampDelt;\n\n    _classCallCheck(this, AuthenticationProofPurpose);\n\n    _this = _super.call(this, {\n      term: term,\n      controller: controller,\n      date: date,\n      maxTimestampDelta: maxTimestampDelta\n    });\n\n    if (typeof challenge !== 'string') {\n      throw new TypeError('\"challenge\" must be a string.');\n    }\n\n    if (domain !== undefined && typeof domain !== 'string') {\n      throw new TypeError('\"domain\" must be a string.');\n    }\n\n    _this.challenge = challenge;\n    _this.domain = domain;\n    return _this;\n  }\n\n  _createClass(AuthenticationProofPurpose, [{\n    key: \"validate\",\n    value: function () {\n      var _validate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(proof, _ref2) {\n        var verificationMethod, documentLoader, expansionMap;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                verificationMethod = _ref2.verificationMethod, documentLoader = _ref2.documentLoader, expansionMap = _ref2.expansionMap;\n                _context.prev = 1;\n\n                if (!(proof.challenge !== this.challenge)) {\n                  _context.next = 4;\n                  break;\n                }\n\n                throw new Error('The challenge is not as expected; ' + \"challenge=\\\"\".concat(proof.challenge, \"\\\", expected=\\\"\").concat(this.challenge, \"\\\"\"));\n\n              case 4:\n                if (!(this.domain !== undefined && proof.domain !== this.domain)) {\n                  _context.next = 6;\n                  break;\n                }\n\n                throw new Error('The domain is not as expected; ' + \"domain=\\\"\".concat(proof.domain, \"\\\", expected=\\\"\").concat(this.domain, \"\\\"\"));\n\n              case 6:\n                return _context.abrupt(\"return\", _get(_getPrototypeOf(AuthenticationProofPurpose.prototype), \"validate\", this).call(this, proof, {\n                  verificationMethod: verificationMethod,\n                  documentLoader: documentLoader,\n                  expansionMap: expansionMap\n                }));\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](1);\n                return _context.abrupt(\"return\", {\n                  valid: false,\n                  error: _context.t0\n                });\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[1, 9]]);\n      }));\n\n      function validate(_x, _x2) {\n        return _validate.apply(this, arguments);\n      }\n\n      return validate;\n    }()\n  }, {\n    key: \"update\",\n    value: function () {\n      var _update = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(proof, _ref3) {\n        var document, suite, documentLoader, expansionMap;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                document = _ref3.document, suite = _ref3.suite, documentLoader = _ref3.documentLoader, expansionMap = _ref3.expansionMap;\n                _context2.next = 3;\n                return _get(_getPrototypeOf(AuthenticationProofPurpose.prototype), \"update\", this).call(this, proof, {\n                  document: document,\n                  suite: suite,\n                  documentLoader: documentLoader,\n                  expansionMap: expansionMap\n                });\n\n              case 3:\n                proof = _context2.sent;\n                proof.challenge = this.challenge;\n\n                if (this.domain !== undefined) {\n                  proof.domain = this.domain;\n                }\n\n                return _context2.abrupt(\"return\", proof);\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function update(_x3, _x4) {\n        return _update.apply(this, arguments);\n      }\n\n      return update;\n    }()\n  }]);\n\n  return AuthenticationProofPurpose;\n}(ControllerProofPurpose);","map":{"version":3,"sources":["D:/My Works/Git/cowin-verify/node_modules/jsonld-signatures/lib/purposes/AuthenticationProofPurpose.js"],"names":["ControllerProofPurpose","require","module","exports","term","controller","challenge","date","domain","maxTimestampDelta","Infinity","TypeError","undefined","proof","verificationMethod","documentLoader","expansionMap","Error","valid","error","document","suite"],"mappings":"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","sourcesContent":["/*!\n * Copyright (c) 2018 Digital Bazaar, Inc. All rights reserved.\n */\n'use strict';\n\nconst ControllerProofPurpose = require('./ControllerProofPurpose');\n\nmodule.exports = class AuthenticationProofPurpose extends\n  ControllerProofPurpose {\n  constructor({\n    term = 'authentication', controller,\n    challenge, date, domain, maxTimestampDelta = Infinity} = {}) {\n    super({term, controller, date, maxTimestampDelta});\n    if(typeof challenge !== 'string') {\n      throw new TypeError('\"challenge\" must be a string.');\n    }\n    if(domain !== undefined && typeof domain !== 'string') {\n      throw new TypeError('\"domain\" must be a string.');\n    }\n    this.challenge = challenge;\n    this.domain = domain;\n  }\n\n  async validate(proof, {verificationMethod, documentLoader, expansionMap}) {\n    try {\n      // check challenge\n      if(proof.challenge !== this.challenge) {\n        throw new Error('The challenge is not as expected; ' +\n          `challenge=\"${proof.challenge}\", expected=\"${this.challenge}\"`);\n      }\n\n      // check domain\n      if(this.domain !== undefined && proof.domain !== this.domain) {\n        throw new Error('The domain is not as expected; ' +\n          `domain=\"${proof.domain}\", expected=\"${this.domain}\"`);\n      }\n\n      return super.validate(\n        proof, {verificationMethod, documentLoader, expansionMap});\n    } catch(error) {\n      return {valid: false, error};\n    }\n  }\n\n  async update(proof, {document, suite, documentLoader, expansionMap}) {\n    proof = await super.update(\n      proof, {document, suite, documentLoader, expansionMap});\n    proof.challenge = this.challenge;\n    if(this.domain !== undefined) {\n      proof.domain = this.domain;\n    }\n    return proof;\n  }\n};\n"]},"metadata":{},"sourceType":"script"}